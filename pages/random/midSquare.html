<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mid-Square Method</title>
    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/mathematical.css">
    <link rel="stylesheet" href="../../css/midSquare.css">
</head>
<body>
    <div class="container">
        <button class="btn back-btn" onclick="window.location.href='../home.html'">← Back to Main Menu</button>
        
        <h1>Mid-Square Method</h1>

        <div class="formula-box">
            <strong>Method:</strong> Square the seed, take the middle 4 digits as the next seed
        </div>

        <div class="form-container">
            <h2>Enter Parameters</h2>
            <div class="input-group">
                <label>Seed (4-digit number, 1000-9999):</label>
                <input type="number" id="seed" placeholder="e.g., 1234" value="1234" min="1000" max="9999">
            </div>
            <div class="input-group count-input-group">
                <label>Number of Random Numbers to Generate: *</label>
                <input type="number" id="count" placeholder="e.g., 10" value="10" min="1" required>
                <small>Enter how many random numbers you want to generate</small>
            </div>
            <button class="btn" onclick="generateMidSquareNumbers()">Generate Random Numbers</button>
        </div>

        <div id="resultsSection" class="results-container hidden">
            <div class="calc-section">
                <h2>Generated Random Numbers</h2>
                <div id="randomNumbersDisplay" class="result-numbers"></div>
                <div class="button-group">
                    <button class="btn small" onclick="copyNumbers()">Copy Numbers</button>
                    <button class="btn start-btn" onclick="goToNextPage()">Next →</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../../js/randomNumbers.js"></script>
    <script>
        let generatedNumbers = [];
        let generationSteps = [];

        function generateMidSquareNumbers() {
            const seed = parseInt(document.getElementById('seed').value);
            const count = parseInt(document.getElementById('count').value);

            // Validation
            if (isNaN(seed)) {
                alert('Please enter a 4-digit seed!');
                return;
            }

            if (isNaN(count) || count === '') {
                alert('Please specify the number of random numbers you want to generate!');
                return;
            }

            if (seed < 1000 || seed > 9999) {
                alert('Seed must be a 4-digit number (1000-9999)!');
                return;
            }

            if (count <= 0) {
                alert('Number of random numbers must be greater than 0!');
                return;
            }

            if (count > 10000) {
                if (!confirm(`You are requesting ${count} random numbers. This may take a moment. Continue?`)) {
                    return;
                }
            }

            try {
                generatedNumbers = generateMidSquare(seed, count);
                displayNumbers(generatedNumbers);
            } catch (error) {
                alert('Error generating numbers: ' + error.message);
            }
        }

        function displayNumbers(numbers) {
            const displayDiv = document.getElementById('randomNumbersDisplay');
            const resultsSection = document.getElementById('resultsSection');
            
            let html = `<strong>Total: ${numbers.length} numbers</strong><br><br>`;
            html += numbers.map((num, index) => {
                return `${index + 1}. ${num.toFixed(6)}`;
            }).join('<br>');
            
            displayDiv.innerHTML = html;
            resultsSection.classList.remove('hidden');
        }

        function copyNumbers() {
            if (generatedNumbers.length === 0) {
                alert('No numbers generated yet!');
                return;
            }
            
            const numbersStr = generatedNumbers.map(n => n.toFixed(6)).join(', ');
            navigator.clipboard.writeText(numbersStr).then(() => {
                alert('Numbers copied to clipboard!');
            }).catch(() => {
                alert('Failed to copy. Please select and copy manually.');
            });
        }

        function goToNextPage() {
            if (generatedNumbers.length === 0) {
                alert('Please generate random numbers first!');
                return;
            }
            
            // Store generated numbers in sessionStorage for use in next page
            sessionStorage.setItem('randomNumbers', JSON.stringify(generatedNumbers));
            sessionStorage.setItem('randomMethod', 'Mid-Square');
            
            // Navigate to simulation page
            window.location.href = '../multiple/multiLimitedCustomer.html';
        }
    </script>
</body>
</html>

