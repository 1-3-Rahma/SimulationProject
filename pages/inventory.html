<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Queue Simulation</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/simulation.css">
    <link rel="stylesheet" href="../css/inventory.css">
</head>
<body>
    <div class="container inventory-container">
        <button class="btn back-btn" onclick="window.location.href='../index.html'">‚Üê Back to Main Menu</button>
        <h1>Inventory Queue Simulation</h1>

        <div id="errorBox" class="error hidden"></div>

        <div class="tabs-nav">
            <button class="tab-btn active" id="tabBtn1" onclick="goToStep(1)">Step 1 ‚Äî Basic Parameters</button>
            <button class="tab-btn" id="tabBtn2" onclick="goToStep(2)">Step 2 ‚Äî Distributions</button>
            <button class="tab-btn" id="tabBtn3" onclick="goToStep(3)">Step 3 ‚Äî Random Numbers</button>
            <button class="tab-btn" id="tabBtn4" onclick="goToStep(4)">Step 4 ‚Äî Results</button>
        </div>

        <!-- Step 1: Basic Inputs -->
        <div id="step1" class="tab-content active">
            <div class="tab-body">
                <h2>Step 1: Basic Parameters</h2>
                <div class="input-grid">
                    <div class="input-group">
                        <label>Standard Inventory Level (M):</label>
                        <input type="number" id="stdInventory" value="100" min="0" required>
                    </div>
                    <div class="input-group">
                        <label>Periodic Review Length (N days):</label>
                        <input type="number" id="reviewLength" value="5" min="1" required>
                    </div>
                    <div class="input-group">
                        <label>Number of Cycles:</label>
                        <input type="number" id="numCycles" value="3" min="1" required>
                    </div>
                    <div class="input-group">
                        <label>Starting Inventory:</label>
                        <input type="number" id="startInventory" value="80" min="0" required>
                    </div>
                </div>
                
                <h2>Pending Orders</h2>
                <div class="pending-orders-container">
                    <div id="pendingOrdersList"></div>
                    <button class="btn btn-secondary" onclick="addPendingOrder()">+ Add Pending Order</button>
                </div>

                <div class="nav-buttons">
                    <button class="btn" onclick="goToStep(2)">Next: Setup Tables</button>
                </div>
            </div>
        </div>

        <!-- Step 2: Demand and Lead Time Tables -->
        <div id="step2" class="tab-content">
            <div class="tab-body">
                <h2>Step 2: Demand Distribution</h2>
                <div class="table-controls">
                    <button class="btn btn-secondary" onclick="addDemandRow()">+ Add Row</button>
                    <input type="number" id="demandRowCount" min="1" max="100" value="1" placeholder="Rows" style="width: 80px; margin: 0 5px; padding: 5px;">
                    <button class="btn btn-secondary" onclick="addMultipleDemandRows()">Generate Rows</button>
                </div>
                <table id="demandTable">
                    <thead>
                        <tr>
                            <th>Demand</th>
                            <th>Probability</th>
                            <th>Cumulative Probability</th>
                            <th>Random-Digit Assignment</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="demandTableBody"></tbody>
                </table>

                <h2>Lead Time Distribution</h2>
                <div class="table-controls">
                    <button class="btn btn-secondary" onclick="addLeadTimeRow()">+ Add Row</button>
                    <input type="number" id="leadTimeRowCount" min="1" max="100" value="1" placeholder="Rows" style="width: 80px; margin: 0 5px; padding: 5px;">
                    <button class="btn btn-secondary" onclick="addMultipleLeadTimeRows()">Generate Rows</button>
                </div>
                <table id="leadTimeTable">
                    <thead>
                        <tr>
                            <th>Lead Time (days)</th>
                            <th>Probability</th>
                            <th>Cumulative Probability</th>
                            <th>Random-Digit Assignment</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="leadTimeTableBody"></tbody>
                </table>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="goToStep(1)">Back</button>
                    <button class="btn" onclick="goToStep(3)">Next: Random Numbers</button>
                </div>
            </div>
        </div>

        <!-- Step 3: Random Numbers -->
        <div id="step3" class="tab-content">
            <div class="tab-body">
                <h2>Step 3: Random Numbers</h2>
                <p>Choose how to provide random numbers for each table: Manual Input or Generated (LCG/Mid-Square)</p>

                <div class="random-tables-container">
                    <div class="random-table-box">
                        <h4>Demand Time Random Numbers</h4>

                        <!-- Demand Method Selection -->
                        <div class="table-method-selector">
                            <div class="method-tabs">
                                <button class="method-tab active" onclick="switchTableMethod('demand', 'manual')" id="tabDemandManual">Manual Input</button>
                                <button class="method-tab" onclick="switchTableMethod('demand', 'generated')" id="tabDemandGenerated">Generated</button>
                            </div>
                        </div>

                        <!-- Manual Input Section for Demand -->
                        <div id="demandManualSection" class="table-method-section active">
                            <div class="table-controls">
                                <button class="btn-add-row" onclick="addRandomNumberRow('demand')">Add Row</button>
                                <input type="number" id="randomDemandRowCount" min="1" max="100" value="5" placeholder="Rows" style="width: 80px; margin: 0 5px; padding: 5px;">
                                <button class="btn btn-secondary" onclick="generateRandomNumberRows('demand')">Generate Rows</button>
                                <button class="btn btn-secondary" onclick="updateRandomNumberCounts()">Update Count</button>
                            </div>
                            <div class="table-container">
                                <table id="tableRnDemand" class="editable-table random-numbers-table">
                                    <thead>
                                        <tr>
                                            <th style="width: 50px;"></th>
                                            <th>Random Number</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbodyRnDemand">
                                        <tr>
                                            <td class="action-cell"><button class="btn-delete-row" onclick="deleteRandomNumberRow(this, 'demand')" title="Delete row">üóëÔ∏è</button></td>
                                            <td><input type="number" class="table-input" min="0" placeholder="Enter number" onchange="updateRandomNumberCounts()"></td>
                                        </tr>
                                        <tr>
                                            <td class="action-cell"><button class="btn-delete-row" onclick="deleteRandomNumberRow(this, 'demand')" title="Delete row">üóëÔ∏è</button></td>
                                            <td><input type="number" class="table-input" min="0" placeholder="Enter number" onchange="updateRandomNumberCounts()"></td>
                                        </tr>
                                        <tr>
                                            <td class="action-cell"><button class="btn-delete-row" onclick="deleteRandomNumberRow(this, 'demand')" title="Delete row">üóëÔ∏è</button></td>
                                            <td><input type="number" class="table-input" min="0" placeholder="Enter number" onchange="updateRandomNumberCounts()"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Generated Section for Demand -->
                        <div id="demandGeneratedSection" class="table-method-section">
                            <div class="generation-method-selector">
                                <label class="radio-label">
                                    <input type="radio" name="demandGenMethod" value="LCG" checked onchange="switchGenMethod('demand', 'LCG')">
                                    <span>Linear Congruential Generator (LCG)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="demandGenMethod" value="MidSquare" onchange="switchGenMethod('demand', 'MidSquare')">
                                    <span>Mid-Square Method</span>
                                </label>
                            </div>

                            <!-- LCG Parameters for Demand -->
                            <div id="demandLcgParams" class="gen-params">
                                <h4>LCG Parameters</h4>
                                <div class="params-grid">
                                    <div class="input-group">
                                        <label>Multiplier (a):</label>
                                        <input type="number" id="demandLcgA" min="0" placeholder="e.g., 1664525">
                                    </div>
                                    <div class="input-group">
                                        <label>Increment (c):</label>
                                        <input type="number" id="demandLcgC" min="0" placeholder="e.g., 1013904223">
                                    </div>
                                    <div class="input-group">
                                        <label>Modulus (m):</label>
                                        <input type="number" id="demandLcgM" min="1" placeholder="e.g., 2^32">
                                    </div>
                                    <div class="input-group">
                                        <label>Initial Seed (Z‚ÇÄ):</label>
                                        <input type="number" id="demandLcgSeed" min="0" placeholder="e.g., 12345">
                                    </div>
                                </div>
                            </div>

                            <!-- Mid-Square Parameters for Demand -->
                            <div id="demandMidSquareParams" class="gen-params hidden">
                                <h4>Mid-Square Parameters</h4>
                                <div class="input-group">
                                    <label>Seed (4-digit, 1000-9999):</label>
                                    <input type="number" id="demandMidSquareSeed" min="1000" max="9999" placeholder="e.g., 1234">
                                </div>
                            </div>

                            <div class="input-group">
                                <label>Number of Demand Random Numbers:</label>
                                <input type="number" id="genDemandCount" min="1" placeholder="e.g., 15">
                            </div>

                            <button class="btn btn-secondary" onclick="generateTableRandomNumbers('demand')">Generate Demand Numbers</button>

                            <div id="demandGeneratedResults" class="generated-results hidden">
                                <h4>Generated Demand Numbers</h4>
                                <div id="genDemandPreview" class="random-preview"></div>
                                <button class="btn btn-secondary" onclick="useGeneratedTableNumbers('demand')">Use These Numbers</button>
                            </div>
                        </div>

                        <small id="demandCount">Count: 3 numbers</small>
                    </div>

                    <div class="random-table-box">
                        <h4>Lead Time Random Numbers</h4>

                        <!-- Lead Time Method Selection -->
                        <div class="table-method-selector">
                            <div class="method-tabs">
                                <button class="method-tab active" onclick="switchTableMethod('leadTime', 'manual')" id="tabLeadTimeManual">Manual Input</button>
                                <button class="method-tab" onclick="switchTableMethod('leadTime', 'generated')" id="tabLeadTimeGenerated">Generated</button>
                            </div>
                        </div>

                        <!-- Manual Input Section for Lead Time -->
                        <div id="leadTimeManualSection" class="table-method-section active">
                            <div class="table-controls">
                                <button class="btn-add-row" onclick="addRandomNumberRow('leadTime')">Add Row</button>
                                <input type="number" id="randomLeadTimeRowCount" min="1" max="100" value="5" placeholder="Rows" style="width: 80px; margin: 0 5px; padding: 5px;">
                                <button class="btn btn-secondary" onclick="generateRandomNumberRows('leadTime')">Generate Rows</button>
                                <button class="btn btn-secondary" onclick="updateRandomNumberCounts()">Update Count</button>
                            </div>
                            <div class="table-container">
                                <table id="tableRnLeadTime" class="editable-table random-numbers-table">
                                    <thead>
                                        <tr>
                                            <th style="width: 50px;"></th>
                                            <th>Random Number</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbodyRnLeadTime">
                                        <tr>
                                            <td class="action-cell"><button class="btn-delete-row" onclick="deleteRandomNumberRow(this, 'leadTime')" title="Delete row">üóëÔ∏è</button></td>
                                            <td><input type="number" class="table-input" min="0" placeholder="Enter number" onchange="updateRandomNumberCounts()"></td>
                                        </tr>
                                        <tr>
                                            <td class="action-cell"><button class="btn-delete-row" onclick="deleteRandomNumberRow(this, 'leadTime')" title="Delete row">üóëÔ∏è</button></td>
                                            <td><input type="number" class="table-input" min="0" placeholder="Enter number" onchange="updateRandomNumberCounts()"></td>
                                        </tr>
                                        <tr>
                                            <td class="action-cell"><button class="btn-delete-row" onclick="deleteRandomNumberRow(this, 'leadTime')" title="Delete row">üóëÔ∏è</button></td>
                                            <td><input type="number" class="table-input" min="0" placeholder="Enter number" onchange="updateRandomNumberCounts()"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Generated Section for Lead Time -->
                        <div id="leadTimeGeneratedSection" class="table-method-section">
                            <div class="generation-method-selector">
                                <label class="radio-label">
                                    <input type="radio" name="leadTimeGenMethod" value="LCG" checked onchange="switchGenMethod('leadTime', 'LCG')">
                                    <span>Linear Congruential Generator (LCG)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="leadTimeGenMethod" value="MidSquare" onchange="switchGenMethod('leadTime', 'MidSquare')">
                                    <span>Mid-Square Method</span>
                                </label>
                            </div>

                            <!-- LCG Parameters for Lead Time -->
                            <div id="leadTimeLcgParams" class="gen-params">
                                <h4>LCG Parameters</h4>
                                <div class="params-grid">
                                    <div class="input-group">
                                        <label>Multiplier (a):</label>
                                        <input type="number" id="leadTimeLcgA" min="0" placeholder="e.g., 1664525">
                                    </div>
                                    <div class="input-group">
                                        <label>Increment (c):</label>
                                        <input type="number" id="leadTimeLcgC" min="0" placeholder="e.g., 1013904223">
                                    </div>
                                    <div class="input-group">
                                        <label>Modulus (m):</label>
                                        <input type="number" id="leadTimeLcgM" min="1" placeholder="e.g., 2^32">
                                    </div>
                                    <div class="input-group">
                                        <label>Initial Seed (Z‚ÇÄ):</label>
                                        <input type="number" id="leadTimeLcgSeed" min="0" placeholder="e.g., 12345">
                                    </div>
                                </div>
                            </div>

                            <!-- Mid-Square Parameters for Lead Time -->
                            <div id="leadTimeMidSquareParams" class="gen-params hidden">
                                <h4>Mid-Square Parameters</h4>
                                <div class="input-group">
                                    <label>Seed (4-digit, 1000-9999):</label>
                                    <input type="number" id="leadTimeMidSquareSeed" min="1000" max="9999" placeholder="e.g., 1234">
                                </div>
                            </div>

                            <div class="input-group">
                                <label>Number of Lead Time Random Numbers:</label>
                                <input type="number" id="genLeadTimeCount" min="1" placeholder="e.g., 5">
                            </div>

                            <button class="btn btn-secondary" onclick="generateTableRandomNumbers('leadTime')">Generate Lead Time Numbers</button>

                            <div id="leadTimeGeneratedResults" class="generated-results hidden">
                                <h4>Generated Lead Time Numbers</h4>
                                <div id="genLeadTimePreview" class="random-preview"></div>
                                <button class="btn btn-secondary" onclick="useGeneratedTableNumbers('leadTime')">Use These Numbers</button>
                            </div>
                        </div>

                        <small id="leadTimeCount">Count: 3 numbers</small>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="goToStep(2)">Back</button>
                    <button class="btn btn-primary" onclick="runSimulation()">Run Simulation</button>
                </div>
            </div>
        </div>

        <!-- Step 4: Simulation Results -->
        <div id="step4" class="tab-content">
            <div class="tab-body">
                <h2>Step 4: Simulation Results</h2>

                <div id="resultsExport">
                    <div id="distributionResults" class="table-container"></div>
                    <div class="simulation-table-container table-container" id="resultsReport">
                        <h3>Simulation Tables</h3>
                        <table id="simulationTable">
                            <thead>
                                <tr>
                                    <th>Cycle</th>
                                    <th>Day</th>
                                    <th>Beginning Inventory</th>
                                    <th>Random Digit (Demand)</th>
                                    <th>Demand</th>
                                    <th>Ending Inventory</th>
                                    <th>Shortage Quantity</th>
                                    <th>Order Quantity</th>
                                    <th>Random Digit (Lead Time)</th>
                                    <th>Days Until Arrival</th>
                                </tr>
                            </thead>
                            <tbody id="simulationTableBody"></tbody>
                        </table>
                    </div>


                    <div id="performanceMeasurements" class="performance-container"></div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goToStep(3)">Back</button>
                    <button class="btn btn-secondary" onclick="resetInventory()">Start Over</button>
                    <button class="btn btn-primary" onclick="downloadInventoryPDF()">Download PDF</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="../js/randomNumbers.js"></script>
    <script src="../js/inventory.js"></script>
</body>
</html>


