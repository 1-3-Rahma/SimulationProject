<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Queue Simulation</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/simulation.css">
    <link rel="stylesheet" href="../css/inventory.css">
</head>
<body>
    <div class="container inventory-container">
        <button class="btn back-btn" onclick="window.location.href='../index.html'">← Back to Main Menu</button>
        <h1>Inventory Queue Simulation</h1>

        <div id="errorBox" class="error hidden"></div>

        <div class="tabs-nav">
            <button class="tab-btn active" id="tabBtn1" onclick="goToStep(1)">Step 1 — Basic Parameters</button>
            <button class="tab-btn" id="tabBtn2" onclick="goToStep(2)">Step 2 — Distributions</button>
            <button class="tab-btn" id="tabBtn3" onclick="goToStep(3)">Step 3 — Random Numbers</button>
            <button class="tab-btn" id="tabBtn4" onclick="goToStep(4)">Step 4 — Results</button>
        </div>

        <!-- Step 1: Basic Inputs -->
        <div id="step1" class="tab-content active">
            <div class="tab-body">
                <h2>Step 1: Basic Parameters</h2>
                <div class="input-grid">
                    <div class="input-group">
                        <label>Standard Inventory Level (M):</label>
                        <input type="number" id="stdInventory" value="100" min="0" required>
                    </div>
                    <div class="input-group">
                        <label>Periodic Review Length (N days):</label>
                        <input type="number" id="reviewLength" value="5" min="1" required>
                    </div>
                    <div class="input-group">
                        <label>Number of Cycles:</label>
                        <input type="number" id="numCycles" value="3" min="1" required>
                    </div>
                    <div class="input-group">
                        <label>Starting Inventory:</label>
                        <input type="number" id="startInventory" value="80" min="0" required>
                    </div>
                </div>
                
                <h2>Pending Orders</h2>
                <div class="pending-orders-container">
                    <div id="pendingOrdersList"></div>
                    <button class="btn btn-secondary" onclick="addPendingOrder()">+ Add Pending Order</button>
                </div>

                <div class="nav-buttons">
                    <button class="btn" onclick="goToStep(2)">Next: Setup Tables</button>
                </div>
            </div>
        </div>

        <!-- Step 2: Demand and Lead Time Tables -->
        <div id="step2" class="tab-content">
            <div class="tab-body">
                <h2>Step 2: Demand Distribution</h2>
                <div class="table-controls">
                    <button class="btn btn-secondary" onclick="addDemandRow()">+ Add Row</button>
                    <input type="number" id="demandRowCount" min="1" max="100" value="1" placeholder="Rows" style="width: 80px; margin: 0 5px; padding: 5px;">
                    <button class="btn btn-secondary" onclick="addMultipleDemandRows()">Generate Rows</button>
                </div>
                <table id="demandTable">
                    <thead>
                        <tr>
                            <th>Demand</th>
                            <th>Probability</th>
                            <th>Cumulative Probability</th>
                            <th>Random-Digit Assignment</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="demandTableBody"></tbody>
                </table>

                <h2>Lead Time Distribution</h2>
                <div class="table-controls">
                    <button class="btn btn-secondary" onclick="addLeadTimeRow()">+ Add Row</button>
                    <input type="number" id="leadTimeRowCount" min="1" max="100" value="1" placeholder="Rows" style="width: 80px; margin: 0 5px; padding: 5px;">
                    <button class="btn btn-secondary" onclick="addMultipleLeadTimeRows()">Generate Rows</button>
                </div>
                <table id="leadTimeTable">
                    <thead>
                        <tr>
                            <th>Lead Time (days)</th>
                            <th>Probability</th>
                            <th>Cumulative Probability</th>
                            <th>Random-Digit Assignment</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="leadTimeTableBody"></tbody>
                </table>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="goToStep(1)">Back</button>
                    <button class="btn" onclick="goToStep(3)">Next: Random Numbers</button>
                </div>
            </div>
        </div>

        <!-- Step 3: Random Numbers -->
        <div id="step3" class="tab-content">
            <div class="tab-body">
                <h2>Step 3: Random Numbers</h2>

                <div class="method-tabs">
                    <button class="method-tab active" id="tabManual" onclick="switchRandomMethod('manual')">Manual Random Entry</button>
                    <button class="method-tab" id="tabLCG" onclick="switchRandomMethod('LCG')">LCG Generation</button>
                    <button class="method-tab" id="tabMidSquare" onclick="switchRandomMethod('MidSquare')">MidSquare Generation</button>
                </div>

                <!-- Manual Entry -->
                <div id="manualRandomSection" class="method-section active">
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Number of Demand Random Numbers:</label>
                            <input type="number" id="numDemandRandoms" value="15" min="1">
                        </div>
                        <div class="input-group">
                            <label>Number of Lead Time Random Numbers:</label>
                            <input type="number" id="numLeadTimeRandoms" value="5" min="1">
                        </div>
                    </div>
                    <button class="btn" onclick="generateRandomInputs()">Generate Input Fields</button>

                    <h2>Demand Random Numbers</h2>
                    <div id="demandRandoms" class="random-numbers-grid"></div>

                    <h2>Lead Time Random Numbers</h2>
                    <div id="leadTimeRandoms" class="random-numbers-grid"></div>
                </div>

                <!-- LCG Generation -->
                <div id="lcgRandomSection" class="method-section">
                    <h3>Linear Congruential Generator (LCG)</h3>
                    <p>Generate random numbers using LCG method</p>
                    
                    <div class="gen-params">
                        <h4>LCG Parameters</h4>
                        <div class="params-grid">
                            <div class="input-group">
                                <label>Multiplier (a):</label>
                                <input type="number" id="lcgA" min="0" placeholder="e.g., 1664525">
                            </div>
                            <div class="input-group">
                                <label>Increment (c):</label>
                                <input type="number" id="lcgC" min="0" placeholder="e.g., 1013904223">
                            </div>
                            <div class="input-group">
                                <label>Modulus (m):</label>
                                <input type="number" id="lcgM" min="1" placeholder="e.g., 2^32">
                            </div>
                            <div class="input-group">
                                <label>Initial Seed (Z₀):</label>
                                <input type="number" id="lcgSeed" min="0" placeholder="e.g., 12345">
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Number of Demand Random Numbers:</label>
                            <input type="number" id="lcgDemandCount" min="1" placeholder="e.g., 15">
                        </div>
                        <div class="input-group">
                            <label>Number of Lead Time Random Numbers:</label>
                            <input type="number" id="lcgLeadTimeCount" min="1" placeholder="e.g., 5">
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="generateLCGRandoms()">Generate Random Numbers</button>
                    
                    <div id="lcgResults" class="generated-results hidden">
                        <h4>Generated Numbers</h4>
                        <div class="results-display">
                            <div>
                                <strong>Demand Numbers:</strong>
                                <div id="lcgDemandPreview" class="random-preview"></div>
                            </div>
                            <div>
                                <strong>Lead Time Numbers:</strong>
                                <div id="lcgLeadTimePreview" class="random-preview"></div>
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="useLCGNumbers()">Use These Numbers</button>
                    </div>
                </div>

                <!-- MidSquare Generation -->
                <div id="midSquareRandomSection" class="method-section">
                    <h3>Mid-Square Method</h3>
                    <p>Generate random numbers using Mid-Square method</p>
                    
                    <div class="gen-params">
                        <h4>Mid-Square Parameters</h4>
                        <div class="input-group">
                            <label>Seed (4-digit, 1000-9999):</label>
                            <input type="number" id="midSquareSeed" min="1000" max="9999" placeholder="e.g., 1234">
                        </div>
                    </div>
                    
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Number of Demand Random Numbers:</label>
                            <input type="number" id="midSquareDemandCount" min="1" placeholder="e.g., 15">
                        </div>
                        <div class="input-group">
                            <label>Number of Lead Time Random Numbers:</label>
                            <input type="number" id="midSquareLeadTimeCount" min="1" placeholder="e.g., 5">
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="generateMidSquareRandoms()">Generate Random Numbers</button>
                    
                    <div id="midSquareResults" class="generated-results hidden">
                        <h4>Generated Numbers</h4>
                        <div class="results-display">
                            <div>
                                <strong>Demand Numbers:</strong>
                                <div id="midSquareDemandPreview" class="random-preview"></div>
                            </div>
                            <div>
                                <strong>Lead Time Numbers:</strong>
                                <div id="midSquareLeadTimePreview" class="random-preview"></div>
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="useMidSquareNumbers()">Use These Numbers</button>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="goToStep(2)">Back</button>
                    <button class="btn btn-primary" onclick="runSimulation()">Run Simulation</button>
                </div>
            </div>
        </div>

        <!-- Step 4: Simulation Results -->
        <div id="step4" class="tab-content">
            <div class="tab-body">
                <h2>Step 4: Simulation Results</h2>

                <div id="resultsExport">
                    <div id="distributionResults" class="table-container"></div>
                    <div class="simulation-table-container table-container" id="resultsReport">
                        <h3>Simulation Tables</h3>
                        <table id="simulationTable">
                            <thead>
                                <tr>
                                    <th>Cycle</th>
                                    <th>Day</th>
                                    <th>Beginning Inventory</th>
                                    <th>Random Digit (Demand)</th>
                                    <th>Demand</th>
                                    <th>Ending Inventory</th>
                                    <th>Shortage Quantity</th>
                                    <th>Order Quantity</th>
                                    <th>Random Digit (Lead Time)</th>
                                    <th>Days Until Arrival</th>
                                </tr>
                            </thead>
                            <tbody id="simulationTableBody"></tbody>
                        </table>
                    </div>


                    <div id="performanceMeasurements" class="performance-container"></div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goToStep(3)">Back</button>
                    <button class="btn btn-secondary" onclick="resetInventory()">Start Over</button>
                    <button class="btn btn-primary" onclick="downloadInventoryPDF()">Download PDF</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="../js/randomNumbers.js"></script>
    <script src="../js/inventory.js"></script>
</body>
</html>


